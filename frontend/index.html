<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebAssembly 2.0 + Rust 1.90 æ¼”ç¤º</title>
    <meta name="description" content="é«˜æ€§èƒ½WebAssemblyåº”ç”¨æ¼”ç¤ºå¹³å°ï¼Œå±•ç¤ºWebAssembly 2.0å’ŒRust 1.90çš„æœ€æ–°ç‰¹æ€§">
    <meta name="keywords" content="WebAssembly, Rust, æ€§èƒ½, æ¼”ç¤º, å‰ç«¯, åç«¯">
    <meta name="author" content="WebAssembly Rust Team">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://your-domain.com/">
    <meta property="og:title" content="WebAssembly 2.0 + Rust 1.90 æ¼”ç¤º">
    <meta property="og:description" content="é«˜æ€§èƒ½WebAssemblyåº”ç”¨æ¼”ç¤ºå¹³å°">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://your-domain.com/">
    <meta property="og:image" content="https://your-domain.com/og-image.png">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="WebAssembly 2.0 + Rust 1.90 æ¼”ç¤º">
    <meta name="twitter:description" content="é«˜æ€§èƒ½WebAssemblyåº”ç”¨æ¼”ç¤ºå¹³å°">
    <meta name="twitter:image" content="https://your-domain.com/twitter-image.png">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }

        .header h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .demo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .demo-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .demo-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
        }

        .demo-card h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }

        .demo-card p {
            margin-bottom: 20px;
            line-height: 1.6;
            color: #666;
        }

        .demo-controls {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .input-group label {
            font-weight: 600;
            color: #333;
        }

        .input-group input, .input-group select {
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .result {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #667eea;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            word-break: break-all;
        }

        .loading {
            display: none;
            text-align: center;
            color: #667eea;
            font-weight: 600;
        }

        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .performance-stats {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 40px;
        }

        .performance-stats h2 {
            color: #667eea;
            margin-bottom: 20px;
            text-align: center;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .stat-item {
            text-align: center;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #666;
            font-size: 0.9rem;
        }

        .footer {
            text-align: center;
            color: white;
            opacity: 0.8;
            margin-top: 40px;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .demo-grid {
                grid-template-columns: 1fr;
            }
            
            .container {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header" role="banner">
            <h1>ğŸš€ WebAssembly 2.0 + Rust 1.90</h1>
            <p>é«˜æ€§èƒ½WebAssemblyåº”ç”¨æ¼”ç¤ºå¹³å°</p>
        </header>

        <section class="performance-stats" aria-labelledby="performance-stats-title">
            <h2 id="performance-stats-title">ğŸ“Š æ€§èƒ½ç»Ÿè®¡</h2>
            <div class="stats-grid" role="region" aria-label="æ€§èƒ½æŒ‡æ ‡">
                <div class="stat-item" role="img" aria-label="åŠ è½½æ—¶é—´">
                    <div class="stat-value" id="loadTime" aria-live="polite">-</div>
                    <div class="stat-label">åŠ è½½æ—¶é—´ (ms)</div>
                </div>
                <div class="stat-item" role="img" aria-label="å†…å­˜ä½¿ç”¨">
                    <div class="stat-value" id="memoryUsage" aria-live="polite">-</div>
                    <div class="stat-label">å†…å­˜ä½¿ç”¨ (MB)</div>
                </div>
                <div class="stat-item" role="img" aria-label="æ‰§è¡Œæ—¶é—´">
                    <div class="stat-value" id="executionTime" aria-live="polite">-</div>
                    <div class="stat-label">æ‰§è¡Œæ—¶é—´ (ms)</div>
                </div>
                <div class="stat-item" role="img" aria-label="ååé‡">
                    <div class="stat-value" id="throughput" aria-live="polite">-</div>
                    <div class="stat-label">ååé‡ (ops/s)</div>
                </div>
            </div>
        </section>

        <main class="demo-grid" role="main" aria-label="æ¼”ç¤ºåŠŸèƒ½">
            <!-- åŸºç¡€ç¤ºä¾‹ -->
            <article class="demo-card" role="region" aria-labelledby="basic-demo-title">
                <h2 id="basic-demo-title">ğŸ¦€ åŸºç¡€ç¤ºä¾‹</h2>
                <p>æ¼”ç¤ºRust 1.90æ–°ç‰¹æ€§å’ŒåŸºæœ¬çš„WebAssemblyåŠŸèƒ½</p>
                <div class="demo-controls">
                    <div class="input-group">
                        <label for="fibInput">æ–æ³¢é‚£å¥‘æ•°åˆ—è®¡ç®—</label>
                        <input type="number" id="fibInput" value="40" min="1" max="50" 
                               aria-describedby="fibInput-help" 
                               aria-label="è¾“å…¥æ–æ³¢é‚£å¥‘æ•°åˆ—çš„é¡¹æ•°">
                        <div id="fibInput-help" class="sr-only">è¾“å…¥1åˆ°50ä¹‹é—´çš„æ•°å­—æ¥è®¡ç®—æ–æ³¢é‚£å¥‘æ•°åˆ—</div>
                    </div>
                    <button class="btn" onclick="runBasicDemo()" 
                            aria-describedby="basicResult"
                            aria-label="è¿è¡ŒåŸºç¡€ç¤ºä¾‹è®¡ç®—æ–æ³¢é‚£å¥‘æ•°åˆ—">
                        è¿è¡ŒåŸºç¡€ç¤ºä¾‹
                    </button>
                    <div class="loading" id="basicLoading" role="status" aria-live="polite" style="display: none;">
                        <div class="spinner" aria-hidden="true"></div>
                        <span>è®¡ç®—ä¸­...</span>
                    </div>
                    <div class="result" id="basicResult" role="status" aria-live="polite" style="display: none;"></div>
                </div>
            </article>

            <!-- é«˜çº§ç¤ºä¾‹ -->
            <div class="demo-card">
                <h2>ğŸŒ é«˜çº§ç¤ºä¾‹</h2>
                <p>å±•ç¤ºWebAssembly 2.0æ–°ç‰¹æ€§å’Œå¤æ‚è®¡ç®—</p>
                <div class="demo-controls">
                    <div class="input-group">
                        <label for="matrixSize">çŸ©é˜µå¤§å°</label>
                        <input type="number" id="matrixSize" value="100" min="10" max="500">
                    </div>
                    <div class="input-group">
                        <label for="iterations">è¿­ä»£æ¬¡æ•°</label>
                        <input type="number" id="iterations" value="100" min="1" max="1000">
                    </div>
                    <button class="btn" onclick="runAdvancedDemo()">è¿è¡Œé«˜çº§ç¤ºä¾‹</button>
                    <div class="loading" id="advancedLoading">
                        <div class="spinner"></div>å¤„ç†ä¸­...
                    </div>
                    <div class="result" id="advancedResult" style="display: none;"></div>
                </div>
            </div>

            <!-- æ€§èƒ½ç¤ºä¾‹ -->
            <div class="demo-card">
                <h2>âš¡ æ€§èƒ½ç¤ºä¾‹</h2>
                <p>æµ‹è¯•WebAssemblyæ€§èƒ½ä¼˜åŒ–å’ŒSIMDæ“ä½œ</p>
                <div class="demo-controls">
                    <div class="input-group">
                        <label for="perfTest">æ€§èƒ½æµ‹è¯•ç±»å‹</label>
                        <select id="perfTest">
                            <option value="fibonacci">æ–æ³¢é‚£å¥‘ç¼“å­˜</option>
                            <option value="matrix">çŸ©é˜µä¹˜æ³•</option>
                            <option value="sorting">å¿«é€Ÿæ’åº</option>
                            <option value="simd">SIMDå‘é‡è¿ç®—</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label for="perfSize">æ•°æ®å¤§å°</label>
                        <input type="number" id="perfSize" value="1000" min="100" max="10000">
                    </div>
                    <button class="btn" onclick="runPerformanceDemo()">è¿è¡Œæ€§èƒ½æµ‹è¯•</button>
                    <div class="loading" id="performanceLoading">
                        <div class="spinner"></div>æµ‹è¯•ä¸­...
                    </div>
                    <div class="result" id="performanceResult" style="display: none;"></div>
                </div>
            </div>

            <!-- å›¾åƒå¤„ç†ç¤ºä¾‹ -->
            <div class="demo-card">
                <h2>ğŸ–¼ï¸ å›¾åƒå¤„ç†</h2>
                <p>WebAssemblyå›¾åƒå¤„ç†å’Œæ»¤é•œæ•ˆæœ</p>
                <div class="demo-controls">
                    <div class="input-group">
                        <label for="imageFilter">æ»¤é•œç±»å‹</label>
                        <select id="imageFilter">
                            <option value="grayscale">ç°åº¦</option>
                            <option value="blur">æ¨¡ç³Š</option>
                            <option value="sharpen">é”åŒ–</option>
                            <option value="edge_detect">è¾¹ç¼˜æ£€æµ‹</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label for="imageSize">å›¾åƒå¤§å°</label>
                        <input type="number" id="imageSize" value="256" min="64" max="1024">
                    </div>
                    <button class="btn" onclick="runImageDemo()">è¿è¡Œå›¾åƒå¤„ç†</button>
                    <div class="loading" id="imageLoading">
                        <div class="spinner"></div>å¤„ç†ä¸­...
                    </div>
                    <div class="result" id="imageResult" style="display: none;"></div>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>Â© 2025 WebAssembly 2.0 + Rust 1.90 æ¼”ç¤ºé¡¹ç›®</p>
            <p>åŸºäºæœ€æ–°çš„WebAssemblyå’ŒRustæŠ€æœ¯æ„å»º</p>
        </div>
    </div>

    <script type="module">
        import init, { 
            fibonacci, 
            fibonacci_fast,
            run_matrix_multiply_benchmark,
            run_sorting_benchmark,
            run_simd_benchmark,
            apply_image_filter
        } from './pkg/wasm.js';

        // å…¨å±€å˜é‡
        let wasmModule = null;
        let loadStartTime = performance.now();

        // åˆå§‹åŒ–WebAssemblyæ¨¡å—
        async function initWasm() {
            try {
                await init();
                wasmModule = true;
                
                const loadTime = Math.round(performance.now() - loadStartTime);
                updatePerformanceStats('loadTime', loadTime);
                
                console.log('WebAssemblyæ¨¡å—åŠ è½½æˆåŠŸ');
            } catch (error) {
                console.error('WebAssemblyæ¨¡å—åŠ è½½å¤±è´¥:', error);
                alert('WebAssemblyæ¨¡å—åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥æµè§ˆå™¨å…¼å®¹æ€§');
            }
        }

        // æ›´æ–°æ€§èƒ½ç»Ÿè®¡
        function updatePerformanceStats(stat, value) {
            const element = document.getElementById(stat);
            if (element) {
                element.textContent = value;
            }
        }

        // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
        function showLoading(loadingId) {
            document.getElementById(loadingId).style.display = 'block';
        }

        // éšè—åŠ è½½çŠ¶æ€
        function hideLoading(loadingId) {
            document.getElementById(loadingId).style.display = 'none';
        }

        // æ˜¾ç¤ºç»“æœ
        function showResult(resultId, content) {
            const resultElement = document.getElementById(resultId);
            resultElement.textContent = content;
            resultElement.style.display = 'block';
        }

        // è¿è¡ŒåŸºç¡€ç¤ºä¾‹
        window.runBasicDemo = async function() {
            if (!wasmModule) {
                alert('WebAssemblyæ¨¡å—æœªåŠ è½½');
                return;
            }

            const input = parseInt(document.getElementById('fibInput').value);
            showLoading('basicLoading');

            try {
                const startTime = performance.now();
                const result = fibonacci(input);
                const endTime = performance.now();
                
                const executionTime = Math.round(endTime - startTime);
                updatePerformanceStats('executionTime', executionTime);
                
                showResult('basicResult', `æ–æ³¢é‚£å¥‘æ•°åˆ—ç¬¬${input}é¡¹: ${result}\næ‰§è¡Œæ—¶é—´: ${executionTime}ms`);
            } catch (error) {
                showResult('basicResult', `é”™è¯¯: ${error.message}`);
            } finally {
                hideLoading('basicLoading');
            }
        };

        // è¿è¡Œé«˜çº§ç¤ºä¾‹
        window.runAdvancedDemo = async function() {
            if (!wasmModule) {
                alert('WebAssemblyæ¨¡å—æœªåŠ è½½');
                return;
            }

            const matrixSize = parseInt(document.getElementById('matrixSize').value);
            const iterations = parseInt(document.getElementById('iterations').value);
            showLoading('advancedLoading');

            try {
                const startTime = performance.now();
                const result = run_matrix_multiply_benchmark(matrixSize, iterations);
                const endTime = performance.now();
                
                const executionTime = Math.round(endTime - startTime);
                updatePerformanceStats('executionTime', executionTime);
                
                showResult('advancedResult', `çŸ©é˜µä¹˜æ³•åŸºå‡†æµ‹è¯•å®Œæˆ\nçŸ©é˜µå¤§å°: ${matrixSize}x${matrixSize}\nè¿­ä»£æ¬¡æ•°: ${iterations}\næ‰§è¡Œæ—¶é—´: ${executionTime}ms\nç»“æœ: ${JSON.stringify(result, null, 2)}`);
            } catch (error) {
                showResult('advancedResult', `é”™è¯¯: ${error.message}`);
            } finally {
                hideLoading('advancedLoading');
            }
        };

        // è¿è¡Œæ€§èƒ½ç¤ºä¾‹
        window.runPerformanceDemo = async function() {
            if (!wasmModule) {
                alert('WebAssemblyæ¨¡å—æœªåŠ è½½');
                return;
            }

            const testType = document.getElementById('perfTest').value;
            const size = parseInt(document.getElementById('perfSize').value);
            showLoading('performanceLoading');

            try {
                const startTime = performance.now();
                let result;
                
                switch (testType) {
                    case 'fibonacci':
                        result = fibonacci_fast(size);
                        break;
                    case 'matrix':
                        result = run_matrix_multiply_benchmark(Math.sqrt(size), 10);
                        break;
                    case 'sorting':
                        result = run_sorting_benchmark(size, 10);
                        break;
                    case 'simd':
                        result = run_simd_benchmark(size, 100);
                        break;
                    default:
                        throw new Error('æœªçŸ¥çš„æµ‹è¯•ç±»å‹');
                }
                
                const endTime = performance.now();
                const executionTime = Math.round(endTime - startTime);
                const throughput = Math.round(size / (executionTime / 1000));
                
                updatePerformanceStats('executionTime', executionTime);
                updatePerformanceStats('throughput', throughput);
                
                showResult('performanceResult', `${testType} æ€§èƒ½æµ‹è¯•å®Œæˆ\næ•°æ®å¤§å°: ${size}\næ‰§è¡Œæ—¶é—´: ${executionTime}ms\nååé‡: ${throughput} ops/s\nç»“æœ: ${JSON.stringify(result, null, 2)}`);
            } catch (error) {
                showResult('performanceResult', `é”™è¯¯: ${error.message}`);
            } finally {
                hideLoading('performanceLoading');
            }
        };

        // è¿è¡Œå›¾åƒå¤„ç†ç¤ºä¾‹
        window.runImageDemo = async function() {
            if (!wasmModule) {
                alert('WebAssemblyæ¨¡å—æœªåŠ è½½');
                return;
            }

            const filterType = document.getElementById('imageFilter').value;
            const imageSize = parseInt(document.getElementById('imageSize').value);
            showLoading('imageLoading');

            try {
                const startTime = performance.now();
                const result = apply_image_filter(filterType, imageSize, imageSize);
                const endTime = performance.now();
                
                const executionTime = Math.round(endTime - startTime);
                updatePerformanceStats('executionTime', executionTime);
                
                showResult('imageResult', `å›¾åƒå¤„ç†å®Œæˆ\næ»¤é•œç±»å‹: ${filterType}\nå›¾åƒå¤§å°: ${imageSize}x${imageSize}\næ‰§è¡Œæ—¶é—´: ${executionTime}ms\nç»“æœ: ${JSON.stringify(result, null, 2)}`);
            } catch (error) {
                showResult('imageResult', `é”™è¯¯: ${error.message}`);
            } finally {
                hideLoading('imageLoading');
            }
        };

        // æ›´æ–°å†…å­˜ä½¿ç”¨ç»Ÿè®¡
        function updateMemoryStats() {
            if (performance.memory) {
                const memoryMB = Math.round(performance.memory.usedJSHeapSize / 1024 / 1024);
                updatePerformanceStats('memoryUsage', memoryMB);
            }
        }

        // åˆå§‹åŒ–åº”ç”¨
        async function initApp() {
            await initWasm();
            updateMemoryStats();
            
            // å®šæœŸæ›´æ–°å†…å­˜ç»Ÿè®¡
            setInterval(updateMemoryStats, 1000);
        }

        // å¯åŠ¨åº”ç”¨
        initApp();
    </script>
</body>
</html>
